on_actions = {
	on_startup = {
		effect = {
			if = {
				limit = { # If competitive game rule is selected and Finland is AI at the start of the game
					FIN = {
						is_ai = yes
						foxhole_is_in_competitive_mode = yes
					}
				}
				FIN = {
					swap_ideas = {
						add_idea = FIN_enhanced_sisu
						remove_idea = sisu
					}
				}
			}

			#check for advanced planes rule
			if = {
				limit = {
					OR = {
						has_game_rule = {
							rule = FOXHOLE_ADVANCED_PLANES
							option = NO_JETS
						}
						has_game_rule = {
							rule = FOXHOLE_ADVANCED_PLANES
							option = ENABLED
						}
					}
				}
				every_country = {
					set_technology = {
						foxhole_tech_planes_III = 1
						popup = no
					}
				}
			}

			if = {
				limit = {
					has_game_rule = {
						rule = FOXHOLE_ADVANCED_PLANES
						option = ENABLED
					}
				}
				every_country = {
					set_technology = {
						foxhole_tech_planes_III = 1
						popup = no
					}
					set_technology = {
						foxhole_tech_jets = 1
						popup = no
					}
				}
			}

			#check for strategic bombers rule
			if = {
				limit = {
					OR = {
						has_game_rule = {
							rule = FOXHOLE_STRATEGIC_BOMBERS
							option = RESTRICTED
						}
						has_game_rule = {
							rule = FOXHOLE_STRATEGIC_BOMBERS
							option = ENABLED
						}
					}
				}
				every_country = {
					set_technology = {
						foxhole_tech_strategic_bomber_I = 1
						popup = no
					}
				}
			}

			if = {
				limit = {
					has_game_rule = {
						rule = FOXHOLE_STRATEGIC_BOMBERS
						option = ENABLED
					}
				}
				every_country = {
					set_technology = {
						foxhole_tech_strategic_bomber_I = 1
						popup = no
					}
					set_technology = {
						foxhole_tech_strategic_bombers = 1
						popup = no
					}
				}
			}

			#check for advanced tanks rule
			if = {
				limit = {
					has_game_rule = {
						rule = FOXHOLE_ADVANCED_TANKS
						option = ENABLED
					}
				}
				every_country = {
					set_technology = {
						foxhole_tech_modern_tanks = 1
						popup = no
					}
				}
			}

			#check for advanced subs rule
			if = {
				limit = {
					has_game_rule = {
						rule = FOXHOLE_ADVANCED_SUBMARINES
						option = ENABLED
					}
				}
				every_country = {
					set_technology = {
						foxhole_tech_advanced_submarines = 1
						popup = no
					}
				}
			}
		}
	}

	on_declare_war = {
		effect = {
			if = {
				limit = { # If the declared war is the SCW and the competitive game rule is selected
					SOV = { is_ai = no }
					foxhole_is_in_competitive_mode = yes
					OR = {
						AND = {
							tag = SPA
							FROM = { tag = SPD }
						}
						AND = {
							tag = SPD
							FROM = { tag = SPA }
						}
					}
				} 
				SOV = { add_threat = 1 } # Designed to offset no Soviet volunteers to Spain
			}
		}
	}

	on_annex = {
		effect = {
			if = {
				limit = {
					original_tag = SPR
					FROM = { original_tag = SPR }
					OR = {
						has_war = no
						NOT = { any_enemy_country = { original_tag = SPR } }
					}
				}
				every_state = { limit = { is_on_continent = europe CONTROLLER = { original_tag = SPR } } add_core_of = ROOT } # Add core of annexer to every European state controlled by any Spain
			}
		}
	}
}